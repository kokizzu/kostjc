name: Build and Test ğŸ› ï¸

on:
  workflow_dispatch: null
  pull_request:
    branches:
      - main

jobs:
  GoSetup:
    timeout-minutes: 10
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Setup Go
        uses: actions/setup-go@v4
        with:
          go-version: '^1.24.1'
      - run: |
          make setup
          go mod tidy
  Go-Build:
    timeout-minutes: 10
    needs: Go-Setup
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - run: go build -v ./...
  Go-Test:
    timeout-minutes: 30
    needs: Go-Setup
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Create .env.override
        uses: 1arp/create-a-file-action@0.3
        with:
          file: ".env.override"
      - run: go test -v ./... ./domain/... ./model/...